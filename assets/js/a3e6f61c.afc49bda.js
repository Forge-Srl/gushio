"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[4662],{2549:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"scripting-utilities/timers","title":"Timers","description":"In case you need to wait some time or handle concurrent promises you can use the global object timer.","source":"@site/versioned_docs/version-0.7.2/scripting-utilities/timers.md","sourceDirName":"scripting-utilities","slug":"/scripting-utilities/timers","permalink":"/gushio/docs/0.7.2/scripting-utilities/timers","draft":false,"unlisted":false,"editUrl":"https://github.com/forge-srl/gushio/main/documentation/versioned_docs/version-0.7.2/scripting-utilities/timers.md","tags":[],"version":"0.7.2","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"File Parsing","permalink":"/gushio/docs/0.7.2/scripting-utilities/file-parsing"},"next":{"title":"Exit with error","permalink":"/gushio/docs/0.7.2/scripting-utilities/exit-with-error"}}');var s=t(4848),r=t(8453);const o={sidebar_position:7},a="Timers",c={},l=[];function d(e){const n={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"timers",children:"Timers"})}),"\n",(0,s.jsxs)(n.p,{children:["In case you need to wait some time or handle concurrent promises you can use the global object ",(0,s.jsx)(n.code,{children:"timer"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"timer.sleep()"})," is a promisified version of ",(0,s.jsx)(n.code,{children:"setTimeout()"})," with support to ",(0,s.jsx)(n.code,{children:"AbortController"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"module.exports = {\n    run: async () => {\n        // Simple sleep\n        await timer.sleep(500)\n        \n        // Sleep with result\n        const myValue = await timer.sleep(1000, 'this is the resolved value')\n        \n        // Sleep with AbortController\n        const controller = new AbortController()\n        const sleepPromise = time.sleep(95000, 'the result', {signal: controller.signal})\n        if (someCondition()) {\n            controller.abort()\n        } else {\n            await sleepPromise\n        }\n    }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"timer.race()"})," is a wrapper around ",(0,s.jsx)(n.code,{children:"Promise.race()"})," that internally use an AbortController to abort all the pending\npromises after race ends:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"module.exports = {\n    run: async () => {\n        // Fetch Google only if it takes less than 500 millisecond\n        const result = await timer.race([\n            async signal => await timer.sleep(500, 'default', {signal}),\n            async signal => await fetch('https://www.google.it', {signal})\n        ])\n    }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"timer.track()"})," is a utility function to add ",(0,s.jsx)(n.code,{children:"AbortController"})," support to an existing async function:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"module.exports = {\n    run: async () => {\n        const someFunction = async (arg1, arg2, arg3) => { /*...*/ }\n\n        const someFunctionWithAbort = timer.track(someFunction)\n\n        const result = await timer.race([\n            async signal => await timer.sleep(500, 'default', {signal}),\n            async signal => await someFunctionWithAbort('value1', 'value2', 'value3', {signal})\n        ])\n    }\n}\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var i=t(6540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);